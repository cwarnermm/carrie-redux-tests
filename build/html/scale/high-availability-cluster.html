<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Elasticsearch" href="elasticsearch.html" /><link rel="prev" title="Scaling for Enterprise" href="scaling-for-enterprise.html" />
        <link rel="canonical" href="https://www.ethereal.cc/redux/scale/high-availability-cluster.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>High availability cluster - Mattermost documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/compass-icons.css?v=b28d7826" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Noto Sans, Helvetica Neue, Arial, sans-serif;
  --font-stack--monospace: Fira Mono, Courier New, Courier, monospace;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Mattermost  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Mattermost  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview/index.html">About Mattermost</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of About Mattermost</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/product.html">Mattermost overview</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../about/use-cases.html">Use cases</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Use cases</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/secure-command-and-control.html">Secure command and control</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../about/unified-collaboration.html">Unified communication</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Unified communication</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../about/mattermost-for-microsoft-teams.html">Mattermost for Microsoft Teams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/mattermost-google-calendar-integration.html">Mattermost Google Calendar integration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../about/devops-collaboration.html">DevOps collaboration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/incident-response-collaboration.html">Incident response collaboration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/security.html">Security overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/integrations.html">Integrations overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/subscription.html">Subscription overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/self-hosted-subscriptions.html">Self-hosted subscriptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/cloud-subscriptions.html">Cloud subscriptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/editions-and-offerings.html">Mattermost editions and plans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/corporate-directory-integration.html">Corporate directory integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/certifications-and-compliance.html">Certifications and compliance overview</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../about/frequently-asked-questions.html">Frequently asked questions (FAQ)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Frequently asked questions (FAQ)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-general.html">General Mattermost questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-community.html">Community questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-notifications.html">Notifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-video-audio-screensharing.html">Video, audio, and screen sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-enterprise.html">Enterprise questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-license.html">License questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-integrations.html">Integrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-use-cases.html">Use cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-product.html">Product questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-high-trust.html">High trust questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-design-decisions.html">Design decisions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-business.html">Business questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/faq-illicit-use.html">Illicit use</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../guides/deployment.html">Deploy Mattermost</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Deploy Mattermost</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../install/prepare-mattermost-database.html">Prepare your Mattermost database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/install-ubuntu.html">Deploy on Ubuntu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/install-docker.html">Deploy using Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/install-tar.html">Deploy with a tarball</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/installing-mattermost-omnibus.html">Deploy using Omnibus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/install-kubernetes.html">Deploy using Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/install-rhel-8.html">Deploy on Red Hat</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/prepare-for-your-mattermost-deployment.html">Prepare for your Mattermost deployment</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Prepare for your Mattermost deployment</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/software-hardware-requirements.html">  Software and hardware requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/mattermost-kubernetes-operator.html">  About the Mattermost Kubernetes Operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/admin-onboarding-tasks.html">  Administrator tasks</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../getting-started/architecture-overview.html">  Architecture overview</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of   Architecture overview</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/implementation-plan.html">  Plan your Mattermost implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/enterprise-roll-out-checklist.html">  Enterprise roll out checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/welcome-email-to-end-users.html">  Welcome email template</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/deployment-guides.html">Deployment guides</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Deployment guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../guides/server-deployment.html">Server deployment</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Server deployment</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../deploy/deployment-overview.html"> Deployment overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/setting-up-socket-based-mattermost-database.html"> Set up a socket-based Mattermost database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/image-proxy.html"> Image proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/backup-disaster-recovery.html"> Backup and disaster recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/encryption-options.html"> Encryption options</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../install/transport-encryption.html"> Configure transport encryption</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of  Configure transport encryption</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../install/proxy-to-mattermost-transport-encryption.html">Configuring proxy to Mattermost transport encryption</a></li>
<li class="toctree-l5"><a class="reference internal" href="../install/database-transport-encryption.html">Configuring database transport encryption</a></li>
<li class="toctree-l5"><a class="reference internal" href="../install/cluster-transport-encryption.html">Configuring cluster transport encryption</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/bleve-search.html"> Bleve search</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../guides/desktop-mobile-app-deployment.html">Desktop and mobile app deployment</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Desktop and mobile app deployment</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../deploy/desktop-app.html">Desktop app deployment guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/desktop-msi-installer-and-group-policy-install.html">Desktop MSI installer and group policy installation guides (beta)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/desktop-custom-dictionaries.html">Desktop App custom dictionaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/desktop-app-managed-resources.html">Desktop managed resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/use-prebuilt-mobile-apps.html">Using Mattermost’s pre-built mobile apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/mobile-testing-notifications.html">Testing push notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/mobile-overview.html">Deploy Mattermost mobile apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/mobile-hpns.html">Mobile push notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/build-custom-mobile-apps.html">Building and distributing your own custom Mattermost mobile apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/deploy-mobile-apps-using-emm-provider.html">Deploying mobile apps using an EMM provider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/mobile-appconfig.html">AppConfig for EMM solutions with Mattermost Mobile Apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/consider-mobile-vpn-options.html">Mobile VPN options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/mobile-faq.html">Mobile apps FAQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deploy/client-side-data.html">Client-side data storage FAQ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/upgrade-mattermost.html">Upgrade Mattermost</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Upgrade Mattermost</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/prepare-to-upgrade-mattermost.html"> Prepare to upgrade Mattermost</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrading-mattermost-server.html"> Upgrade Mattermost Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/enterprise-install-upgrade.html"> Enterprise install and upgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/installing-license-key.html"> Install a license key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/release-definitions.html"> Release definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/important-upgrade-notes.html"> Important upgrade notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/release-lifecycle.html"> Release lifecycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/extended-support-release.html"> Extended Support Release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/downgrading-mattermost-server.html"> Downgrade Mattermost Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/version-archive.html"> Version archive</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../guides/scale-mattermost.html">Scale Mattermost</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Scale Mattermost</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="scaling-for-enterprise.html"> Scale for Enterprise</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#"> High availability cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="elasticsearch.html"> Elasticsearch</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance-monitoring.html"> Performance monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance-alerting.html"> Mattermost performance alerting guide</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/deployment-troubleshooting.html">Deployment troubleshooting</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Deployment troubleshooting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/troubleshooting.html">  General troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deploy/high-scale-troubleshoot.html">  Troubleshooting your high scale deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deploy/mobile-troubleshoot.html">  Troubleshooting mobile applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/trouble-postgres.html">  PostgreSQL installation troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/trouble_mysql.html">  MySQL installation troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/changelogs.html">Changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Changelogs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/self-managed-changelog.html">  Mattermost self-hosted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/legacy-self-hosted-changelog.html">  Mattermost legacy self-hosted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/cloud-changelog.html">  Mattermost Cloud</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deploy/mobile-app-changelog.html">  Mobile apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/desktop-app-changelog.html">  Desktop apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/deprecated-features.html">  Deprecated features</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/additional-server-installation-guides.html">Additional server installation guides</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Additional server installation guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/deploying-team-edition-on-bitnami.html">  Deploy Mattermost on Bitnami</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/setting-up-aws-elastic-beanstalk-docker.html">  AWS Elastic Beanstalk Docker setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/installing-team-edition-helm-chart.html">  Install Mattermost Team Edition in GitLab Helm Chart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/open-source-components.html">  Open source components</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/administration.html">Manage Mattermost</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Manage Mattermost</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/get-started-with-administration.html">Get started</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Get started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configure/optimize-your-workspace.html">Optimize your workspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/configuration-settings.html">Mattermost configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/self-hosted-account-settings.html">Self-hosted edition and license</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/cloud-billing-account-settings.html">Cloud subscription, billing, and account</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/reporting-configuration-settings.html">Reporting configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/user-management-configuration-settings.html">User management configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/environment-configuration-settings.html">Environment configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/site-configuration-settings.html">Site configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/authentication-configuration-settings.html">Authentication configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/plugins-configuration-settings.html">Plugins configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/integrations-configuration-settings.html">Integrations configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/compliance-configuration-settings.html">Compliance configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/experimental-configuration-settings.html">Experimental configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/deprecated-configuration-settings.html">Deprecated configuration settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/environment-variables.html">Environment variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/user-provisioning-workflows.html">Provisioning workflows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/multi-factor-authentication.html">Multi-factor authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/ad-ldap.html">Active Directory/LDAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/sso-gitlab.html">GitLab SSO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/sso-openidconnect.html">OpenID SSO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/sso-google.html">Google SSO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/sso-office.html">Office 365 SSO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/advanced-permissions.html">Advanced permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/system-admin-roles.html">System admin roles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/team-channel-members.html">Manage team and channel members</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/custom-branding-tools.html">Custom branding tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/electronic-discovery.html">eDiscovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/compliance-monitoring.html">Compliance monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/compliance-export.html">Compliance export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/legal-hold.html">Legal hold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/data-retention-policy.html">Data retention tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/custom-terms-of-service.html">Custom terms of service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/notify-admin.html">Notify Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/ad-ldap-groups-synchronization.html">AD/LDAP groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/managing-team-channel-membership-using-ad-ldap-sync-groups.html">Use AD/LDAP synchronized groups to manage team or private channel membership</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/guest-accounts.html">Guest accounts</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../onboard/sso-saml.html">SAML Single Sign-On</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of SAML Single Sign-On</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../onboard/sso-saml-okta.html">Okta SAML Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../onboard/sso-saml-onelogin.html">OneLogin SAML Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../onboard/sso-saml-adfs.html">Microsoft ADFS SAML Configuration for Windows Server 2012</a></li>
<li class="toctree-l4"><a class="reference internal" href="../onboard/sso-saml-adfs-msws2016.html">Microsoft ADFS SAML Configuration for Windows Server 2016</a></li>
<li class="toctree-l4"><a class="reference internal" href="../onboard/sso-saml-keycloak.html">Keycloak SAML Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/sso-saml-technical.html">SAML Single-Sign-On: technical documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/shared-channels.html">Shared channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/statistics.html">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/in-product-notices.html">In-product notices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/user-satisfaction-surveys.html">User satisfaction surveys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/health-checks.html">Health check</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/announcement-banner.html">Announcement banner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/bulk-export-tool.html">Bulk export tool</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/cloud-workspace-management.html">Cloud workspace management</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Cloud workspace management</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manage/cloud-billing.html">Mattermost Cloud billing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/workspace-usage.html">Workspace usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/cloud-data-export.html">Workspace migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/cloud-data-residency.html">Cloud data residency</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/self-hosted-administration.html">Self-hosted administration</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Self-hosted administration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manage/self-hosted-billing.html">Mattermost self-hosted billing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/configuation-in-a-database.html">Store configuration in the database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/bulk-loading-data.html">Bulk loading data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/smtp-email.html">SMTP email setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/email-templates.html">Email templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/calls-deployment.html">Calls deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/configuring-cloudfront-to-host-mattermost-static-assets.html">Configure CloudFront to host static assets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/using-outbound-proxy.html">Use an outbound proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/migrating-to-mattermost.html">Migration guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deploy/postgres-migration.html">Migration from MySQL to PostgreSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/enabling-chinese-japanese-korean-search.html">Chinese, Japanese, and Korean search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configure/customizing-mattermost.html">Customize Mattermost</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/audit-log.html">Audit logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../comply/embedded-json-audit-log-schema.html">JSON audit log schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/ssl-client-certificate.html">SSL client certificate setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/certificate-based-authentication.html">Certificate-based authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/telemetry.html">Manage telemetry</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/other-administration-resources.html">Other resources</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Other resources</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../onboard/convert-oauth20-service-providers-to-openidconnect.html">Convert OAuth 2.0 providers to OpenID Connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/generating-support-packet.html">Generate a support packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/mmctl-command-line-tool.html">mmctl command line tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/migration-announcement-email.html">Migration announcement email template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onboard/advanced-permissions-backend-infrastructure.html">Advanced permissions infrastructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manage/command-line-tools.html">Command line tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/use-mattermost.html">Use Mattermost</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Use Mattermost</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/collaborate.html">Connect and collaborate</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Connect and collaborate</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../collaborate/access-your-workspace.html">Access your Mattermost workspace</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Access your Mattermost workspace</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/install-desktop-app.html">Install the desktop app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/install-ios-app.html">Install the iOS mobile app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/install-android-app.html">Install the Android mobile app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/log-out.html">Log out of Mattermost</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../collaborate/organize-using-teams.html">Organize using teams</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Organize using teams</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/team-settings.html">Team settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/team-keyboard-shortcuts.html">Team keyboard shortcuts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../collaborate/organize-using-custom-user-groups.html">Organize using custom user groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../collaborate/invite-people.html">Invite people</a></li>
<li class="toctree-l3"><a class="reference internal" href="../collaborate/learn-about-roles.html">Learn about Mattermost roles</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../collaborate/collaborate-within-channels.html">Collaborate within channels</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Collaborate within channels</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/channel-types.html">Channel types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/channel-naming-conventions.html">Channel naming conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/channel-header-purpose.html">Communicate a channel's focus and scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/create-channels.html">Create channels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/rename-channels.html">Rename channels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/convert-public-channels.html">Convert public channels to private</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/join-leave-channels.html">Join and leave channels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/make-calls.html">Make calls in Mattermost</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/manage-channel-members.html">Manage channel members</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/browse-channels.html">Browse channels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/navigate-between-channels.html">Navigate between channels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/favorite-channels.html">Mark channels as favorites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/mark-channels-unread.html">Mark channels as unread</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/archive-unarchive-channels.html">Archive and unarchive channels</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../collaborate/communicate-with-messages.html">Communicate with messages and threads</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Communicate with messages and threads</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/send-messages.html">Send messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/reply-to-messages.html">Reply to messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/react-with-emojis-gifs.html">React with emojis and GIFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/organize-conversations.html">Organize conversations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/mark-messages-unread.html">Mark messages as unread</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/forward-messages.html">Forward messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/share-links.html">Share links to channels and messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/save-pin-messages.html">Save and pin messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/message-reminders.html">Set message reminders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/search-for-messages.html">Search for messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/format-messages.html">Format messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/message-priority.html">Set message priority</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/mention-people.html">Mention people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/share-files-in-messages.html">Share files in messages</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../collaborate/keyboard-shortcuts.html">Keyboard shortcuts</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Keyboard shortcuts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/keyboard-accessibility.html">Keyboard accessibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/run-slash-commands.html">Run slash commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/built-in-slash-commands.html">Built-in-slash-commands</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../collaborate/extend-mattermost-with-integrations.html">Extend Mattermost with integrations</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Extend Mattermost with integrations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/collaborate-using-mattermost-for-microsoft-teams.html">Collaborate using Mattermost for MS Teams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../collaborate/use-mattermost-google-calendar-plugin.html">Use the Mattermost Google Calendar plugin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/repeatable-processes.html">Build repeatable processes</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Build repeatable processes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/learn-about-playbooks.html">Learn about playbooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/work-with-playbooks.html">Work with playbooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/work-with-runs.html">Work with runs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/work-with-tasks.html">Work with tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/notifications-and-updates.html">Work with notifications and updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/metrics-and-goals.html">Work with metrics and goals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/share-and-collaborate.html">Share and collaborate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../repeatable-processes/interact-with-playbooks.html">Interact with playbooks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/preferences.html">Customize your preferences</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Customize your preferences</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../preferences/manage-your-notifications.html">Manage your notifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/customize-your-theme.html">Customize your Mattermost theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/customize-your-channel-sidebar.html">Customize your channel sidebar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/manage-your-profile.html">Manage your profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/manage-your-security-preferences.html">Manage your security preferences</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/set-your-status-availability.html">Set your status &amp; availability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/manage-your-display-options.html">Manage your display options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/manage-your-sidebar-options.html">Manage your sidebar options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/manage-advanced-options.html">Manage advanced options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/customize-desktop-app-experience.html">Customize your desktop app experience</a></li>
<li class="toctree-l3"><a class="reference internal" href="../preferences/connect-multiple-workspaces.html">Connect to multiple workspaces</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://developers.mattermost.com/">Develop with Mattermost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/get-help.html">Get help with Mattermost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/community-chat.html">Join our community</a></li>
<li class="toctree-l1"><a class="reference external" href="https://handbook.mattermost.com/">Learn how we work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/contribute-to-documentation.html">Contribute to this documentation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="high-availability-cluster">
<h1>High availability cluster<a class="headerlink" href="#high-availability-cluster" title="Link to this heading">#</a></h1>
<div class="mm-badge"><p><img alt="plans-img" src="../_images/flag_icon.svg" /> Available on <a class="reference external" href="https://mattermost.com/pricing/">Enterprise plans</a></p>
<p><img alt="deployment-img" src="../_images/deployment_icon.svg" /> <a class="reference external" href="https://mattermost.com/deploy/">self-hosted</a> deployments</p>
</div><p><em>Available in legacy Mattermost Enterprise Edition E20</em></p>
<p>A High availability cluster enables a Mattermost system to maintain service during outages and hardware failures through the use of redundant infrastructure.</p>
<p>High availability in Mattermost consists of running redundant Mattermost application servers, redundant database servers, and redundant load balancers. The failure of any one of these components does not interrupt operation of the system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This document applies to Mattermost Server v4.0 and later.</p>
</div>
<section id="requirements-for-continuous-operation">
<h2>Requirements for continuous operation<a class="headerlink" href="#requirements-for-continuous-operation" title="Link to this heading">#</a></h2>
<p>To enable continuous operation at all times, including during server updates and server upgrades, you must make sure that the redundant components are properly sized and that you follow the correct sequence for updating each of the system’s components.</p>
<dl>
<dt>Redundancy at anticipated scale</dt><dd><p>Upon failure of one component, the remaining application servers, database servers, and load balancers must be sized and configured to carry the full load of the system. If this requirement is not met, an outage of one component can result in an overload of the remaining components, causing a complete system outage.</p>
</dd>
<dt>Update sequence for continuous operation</dt><dd><p>You can apply most configuration changes and dot release security updates without interrupting service, provided that you update the system components in the correct sequence. See the <a class="reference internal" href="#upgrade-guide">upgrade guide</a> for instructions on how to do this.</p>
<p><strong>Exception:</strong> Changes to configuration settings that require a server restart, and server version upgrades that involve a change to the database schema, require a short period of downtime. Downtime for a server restart is around five seconds. For a database schema update, downtime can be up to 30 seconds.</p>
</dd>
</dl>
</section>
<section id="deployment-guide">
<h2>Deployment guide<a class="headerlink" href="#deployment-guide" title="Link to this heading">#</a></h2>
<p>Deployment guide to set up and maintain high availability on your Mattermost servers. This document doesn’t cover the configuration of databases in terms of disaster recovery, however, you can refer to the <a class="reference internal" href="#frequently-asked-questions-faq">frequently asked questions (FAQ)</a> section for our recommendations.</p>
<section id="initial-setup-guide-for-high-availability">
<h3>Initial setup guide for high availability<a class="headerlink" href="#initial-setup-guide-for-high-availability" title="Link to this heading">#</a></h3>
<p>To ensure your instance and configuration are compatible with high availability, please review the <a class="reference internal" href="#configuration-and-compatibility">configuration and compatibility</a> section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Back up your Mattermost database and file storage locations before configuring high availability. For more information about backing up, see <a class="reference internal" href="../deploy/backup-disaster-recovery.html"><span class="doc">Backup and disaster recovery</span></a>.</p>
</div>
<ol class="arabic simple">
<li><p>Upgrade Mattermost Server to version 4.0 or later. See <a class="reference internal" href="../upgrade/upgrading-mattermost-server.html"><span class="doc">Upgrade Mattermost Server</span></a>.</p></li>
<li><p>Set up a new Mattermost server with version 4.0 or later by following one of our <strong>Install Guides</strong>. This server must use an identical copy of the configuration file, <code class="docutils literal notranslate"><span class="pre">config.json</span></code>. Verify the servers are functioning by hitting each independent server through its private IP address.</p></li>
<li><p>Modify the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> files on both servers to add <code class="docutils literal notranslate"><span class="pre">ClusterSettings</span></code>. See the <a class="reference external" href="/configure/environment-configuration-settings.html#high-availability">high availability configuration settings</a> documentation for details.</p></li>
<li><p>Verify the configuration files are identical on both servers then restart each machine in the cluster.</p></li>
<li><p>Modify your NGINX setup so that it proxies to both servers. For more information about this, see <a class="reference internal" href="#proxy-server-configuration">proxy server configuration</a>.</p></li>
<li><p>Open <strong>System Console &gt; Environment &gt; High Availability</strong> to verify that each machine in the cluster is communicating as expected with green status indicators. If not, investigate the log files for any extra information.</p></li>
</ol>
</section>
<section id="add-a-server-to-the-cluster">
<h3>Add a server to the cluster<a class="headerlink" href="#add-a-server-to-the-cluster" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Back up your Mattermost database and the file storage location. For more information about backing up, see <a class="reference internal" href="../deploy/backup-disaster-recovery.html"><span class="doc">Backup and disaster recovery</span></a>.</p></li>
<li><p>Set up a new Mattermost server. This server must use an identical copy of the configuration file, <code class="docutils literal notranslate"><span class="pre">config.json</span></code>. Verify the server is functioning by hitting the private IP address.</p></li>
<li><p>Modify your NGINX setup to add the new server.</p></li>
<li><p>Open <strong>System Console &gt; Environment &gt; High Availability</strong> to verify that all the machines in the cluster are communicating as expected with green status indicators. If not, investigate the log files for any extra information.</p></li>
</ol>
</section>
<section id="remove-a-server-from-the-cluster">
<h3>Remove a server from the cluster<a class="headerlink" href="#remove-a-server-from-the-cluster" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Back up your Mattermost database and the file storage location. For more information about backing up, see <a class="reference internal" href="../deploy/backup-disaster-recovery.html"><span class="doc">Backup and disaster recovery</span></a>.</p></li>
<li><p>Modify your NGINX setup to remove the server. For information about this, see <a href="#id1"><span class="problematic" id="id2">``</span></a>proxy server configuration`_.</p></li>
<li><p>Open <strong>System Console &gt; Environment &gt; High Availability</strong> to verify that all the machines remaining in the cluster are communicating as expected with green status indicators. If not, investigate the log files for any extra information.</p></li>
</ol>
</section>
</section>
<section id="configuration-and-compatibility">
<h2>Configuration and compatibility<a class="headerlink" href="#configuration-and-compatibility" title="Link to this heading">#</a></h2>
<p>Details on configuring your system for High Availability.</p>
<section id="mattermost-server-configuration">
<h3>Mattermost Server configuration<a class="headerlink" href="#mattermost-server-configuration" title="Link to this heading">#</a></h3>
<section id="configuration-settings">
<h4>Configuration settings<a class="headerlink" href="#configuration-settings" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>High availability is configured in the <code class="docutils literal notranslate"><span class="pre">ClusterSettings</span></code> section of <code class="docutils literal notranslate"><span class="pre">config.json</span></code> and the settings are viewable in the System Console. When high availability is enabled, the System Console is set to read-only mode to ensure all the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> files on the Mattermost servers are always identical. However, for testing and validating a high availability setup, you can set <code class="docutils literal notranslate"><span class="pre">ReadOnlyConfig</span></code> to <code class="docutils literal notranslate"><span class="pre">false</span></code>, which allows changes made in the System Console to be saved back to the configuration file.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;ClusterSettings&quot;: {
        &quot;Enable&quot;: false,
        &quot;ClusterName&quot;: &quot;production&quot;,
        &quot;OverrideHostname&quot;: &quot;&quot;,
        &quot;UseIpAddress&quot;: true,
        &quot;UseGossip&quot;: true,
        &quot;ReadOnlyConfig&quot;: true,
        &quot;GossipPort&quot;: 8074,
        &quot;StreamingPort&quot;: 8075
}
</pre></div>
</div>
<p>For more details on these settings, see the <a class="reference external" href="/configure/environment-configuration-settings.html#high-availability">high availability configuration settings</a> documentation.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Change the process limit to 8192 and the maximum number of open files to 65536.</p></li>
</ol>
<blockquote>
<div><p>Modify <code class="docutils literal notranslate"><span class="pre">/etc/security/limits.conf</span></code> on each machine that hosts a Mattermost server by adding the following lines:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* soft nofile 65536
* hard nofile 65536
* soft nproc 8192
* hard nproc 8192
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Increase the number of WebSocket connections:</p></li>
</ol>
<blockquote>
<div><p>Modify <code class="docutils literal notranslate"><span class="pre">/etc/sysctl.conf</span></code> on each machine that hosts a Mattermost server by adding the following lines:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>net.ipv4.ip_local_port_range = 1025 65000
net.ipv4.tcp_fin_timeout = 30
net.ipv4.tcp_tw_reuse = 1
net.core.somaxconn = 4096
net.ipv4.tcp_max_syn_backlog = 8192
</pre></div>
</div>
</div></blockquote>
<p>You can do the same for the proxy server.</p>
</section>
<section id="cluster-discovery">
<h4>Cluster discovery<a class="headerlink" href="#cluster-discovery" title="Link to this heading">#</a></h4>
<p>If you have non-standard (i.e. complex) network configurations, then you may need to use the <a class="reference external" href="/configure/environment-configuration-settings.html#ha-overridehostname">Override Hostname</a> setting to help the cluster nodes discover each other. The cluster settings in the config are removed from the config file hash for this reason, meaning you can have <code class="docutils literal notranslate"><span class="pre">config.json</span></code> files that are slightly different in high availability mode. The Override Hostname is intended to be different for each clustered node in <code class="docutils literal notranslate"><span class="pre">config.json</span></code> if you need to force discovery.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">UseIpAddress</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, it attempts to obtain the IP address by searching for the first non-local IP address (non-loop-back, non-localunicast, non-localmulticast network interface). It enumerates the network interfaces using the built-in go function <a class="reference external" href="https://golang.org/pkg/net/#InterfaceAddrs">net.InterfaceAddrs()</a>. Otherwise it tries to get the hostname using the <a class="reference external" href="https://golang.org/pkg/os/#Hostname">os.Hostname()</a> built-in go function.</p>
<p>You can also run <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">ClusterDiscovery</span></code> against your database to see how it has filled in the <strong>Hostname</strong> field. That field will be the hostname or IP address the server will use to attempt contact with other nodes in the cluster. We attempt to make a connection to the <code class="docutils literal notranslate"><span class="pre">url</span> <span class="pre">Hostname:Port</span></code> and <code class="docutils literal notranslate"><span class="pre">Hostname:PortGossipPort</span></code>. You must also make sure you have all the correct ports open so the cluster can gossip correctly. These ports are under <code class="docutils literal notranslate"><span class="pre">ClusterSettings</span></code> in your configuration.</p>
<p>In short, you should use:</p>
<ol class="arabic simple">
<li><p>IP address discovery if the first non-local address can be seen from the other machines.</p></li>
<li><p>Override Hostname on the operating system so that it’s a proper discoverable name for the other nodes in the cluster.</p></li>
<li><p>Override Hostname in <code class="docutils literal notranslate"><span class="pre">config.json</span></code> if the above steps do not work. You can put an IP address in this field if needed. The <code class="docutils literal notranslate"><span class="pre">config.json</span></code> will be different for each cluster node.</p></li>
</ol>
</section>
<section id="time-synchronization">
<h4>Time synchronization<a class="headerlink" href="#time-synchronization" title="Link to this heading">#</a></h4>
<p>Each server in the cluster must have the Network Time Protocol daemon <code class="docutils literal notranslate"><span class="pre">ntpd</span></code> running so that messages are posted in the correct order.</p>
</section>
<section id="state">
<h4>State<a class="headerlink" href="#state" title="Link to this heading">#</a></h4>
<p>The Mattermost server is designed to have very little state to allow for horizontal scaling. The items in state considered for scaling Mattermost are listed below:</p>
<ul class="simple">
<li><p>In memory session cache for quick validation and channel access.</p></li>
<li><p>In memory online/offline cache for quick response.</p></li>
<li><p>System configuration file that is loaded and stored in memory.</p></li>
<li><p>WebSocket connections from clients used to send messages.</p></li>
</ul>
<p>When the Mattermost server is configured for high availability, the servers  use an inter-node communication protocol on a different listening address to keep the state in sync. When a state changes it is written back to the database and an inter-node message is sent to notify the other servers of the state change. The true state of the items can always be read from the database. Mattermost also uses inter-node communication to forward WebSocket messages to the other servers in the cluster for real-time messages such as “[User X] is typing.”</p>
</section>
<section id="proxy-server-configuration">
<h4>Proxy server configuration<a class="headerlink" href="#proxy-server-configuration" title="Link to this heading">#</a></h4>
<p>The proxy server exposes the cluster of Mattermost servers to the outside world. The Mattermost servers are designed for use with a proxy server such as NGINX, a hardware load balancer, or a cloud service like Amazon Elastic Load Balancer.</p>
<p>If you want to monitor the server with a health check you can use <code class="docutils literal notranslate"><span class="pre">http://10.10.10.2/api/v4/system/ping</span></code> and check the response for <code class="docutils literal notranslate"><span class="pre">Status</span> <span class="pre">200</span></code>, indicating success. Use this health check route to mark the server <em>in-service</em> or <em>out-of-service</em>.</p>
<p>A sample configuration for NGINX is provided below. It assumes that you have two Mattermost servers running on private IP addresses of <code class="docutils literal notranslate"><span class="pre">10.10.10.2</span></code> and <code class="docutils literal notranslate"><span class="pre">10.10.10.4</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>upstream backend {
        server 10.10.10.2:8065;
        server 10.10.10.4:8065;
  }

  server {
      server_name mattermost.example.com;

      location ~ /api/v[0-9]+/(users/)?websocket$ {
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection &quot;upgrade&quot;;
            client_max_body_size 50M;
            proxy_set_header Host $http_host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Frame-Options SAMEORIGIN;
            proxy_buffers 256 16k;
            proxy_buffer_size 16k;
            proxy_read_timeout 600s;
            proxy_http_version 1.1;
            proxy_pass http://backend;
      }

      location / {
            client_max_body_size 50M;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection &quot;upgrade&quot;;
            proxy_set_header Host $http_host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Frame-Options SAMEORIGIN;
            proxy_pass http://backend;
      }
}
</pre></div>
</div>
<p>You can use multiple proxy servers to limit a single point of failure, but that is beyond the scope of this documentation.</p>
</section>
<section id="file-storage-configuration">
<h4>File storage configuration<a class="headerlink" href="#file-storage-configuration" title="Link to this heading">#</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>File storage is assumed to be shared between all the machines that are using services such as NAS or Amazon S3.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">&quot;DriverName&quot;:</span> <span class="pre">&quot;local&quot;</span></code> is used then the directory at <code class="docutils literal notranslate"><span class="pre">&quot;FileSettings&quot;:</span></code> <code class="docutils literal notranslate"><span class="pre">&quot;Directory&quot;:</span> <span class="pre">&quot;./data/&quot;</span></code> is expected to be a NAS location mapped as a local directory, otherwise high availability will not function correctly and may corrupt your file storage.</p></li>
<li><p>If you’re using Amazon S3 or MinIO for file storage then no other configuration is required.</p></li>
</ol>
</div>
<p>If you’re using the Compliance Reports feature in Mattermost Enterprise, you need to configure the <code class="docutils literal notranslate"><span class="pre">&quot;ComplianceSettings&quot;:</span></code> <code class="docutils literal notranslate"><span class="pre">&quot;Directory&quot;:</span> <span class="pre">&quot;./data/&quot;,</span></code> to share between all machines or the reports will only be available from the System Console on the local Mattermost server.</p>
<p>Migrating to NAS or S3 from local storage is beyond the scope of this document.</p>
</section>
<section id="database-configuration">
<h4>Database configuration<a class="headerlink" href="#database-configuration" title="Link to this heading">#</a></h4>
<p>Use the read replica feature to scale the database. The Mattermost server can be set up to use one master database and one or more read replica databases.</p>
<p>On large deployments, also consider using the search replica feature to isolate search queries onto one or more search replicas. A search replica is similar to a read replica, but is used only for handling search queries.</p>
<p>Mattermost distributes queries as follows:</p>
<ul class="simple">
<li><p>All write requests, and some specific read requests, are sent to the master.</p></li>
<li><p>All other read requests (excluding those specific queries that go to the master) are distributed among the available read replicas. If no read replicas are available, these are sent to the master instead.</p></li>
<li><p>Search requests are distributed among the available search replicas. If no search replicas are available, these are sent to the read replicas instead (or, if no read replicas are available, to the master).</p></li>
</ul>
<section id="size-the-databases">
<h5>Size the databases<a class="headerlink" href="#size-the-databases" title="Link to this heading">#</a></h5>
<p>For information about sizing database servers, see <a class="reference internal" href="../install/software-hardware-requirements.html#hardware-sizing-for-enterprise"><span class="std std-ref">Hardware requirements for enterprise deployments (multi-server)</span></a>.</p>
<p>In a master/slave environment, make sure to size the slave machine to take 100% of the load in the event that the master machine goes down and you need to fail over.</p>
</section>
<section id="deploy-a-multi-database-configuration">
<h5>Deploy a multi-database configuration<a class="headerlink" href="#deploy-a-multi-database-configuration" title="Link to this heading">#</a></h5>
<p>To configure a multi-database Mattermost server:</p>
<ol class="arabic simple">
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">DataSource</span></code> setting in <code class="docutils literal notranslate"><span class="pre">config.json</span></code> with a connection string to your master database server.</p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">DataSourceReplicas</span></code> setting in <code class="docutils literal notranslate"><span class="pre">config.json</span></code> with a series of connection strings to your database read replica servers in the format <code class="docutils literal notranslate"><span class="pre">[&quot;readreplica1&quot;,</span> <span class="pre">&quot;readreplica2&quot;]</span></code>. Each connection should also be compatible with the <code class="docutils literal notranslate"><span class="pre">DriverName</span></code> setting.</p></li>
</ol>
<p>Here’s an example <code class="docutils literal notranslate"><span class="pre">SqlSettings</span></code> block for one master and two read replicas:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;SqlSettings&quot;: {
      &quot;DriverName&quot;: &quot;mysql&quot;,
      &quot;DataSource&quot;: &quot;master_user:master_password@tcp(master.server)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&quot;,
      &quot;DataSourceReplicas&quot;: [&quot;slave_user:slave_password@tcp(replica1.server)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&quot;,&quot;slave_user:slave_password@tcp(replica2.server)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&quot;],
      &quot;DataSourceSearchReplicas&quot;: [],
      &quot;MaxIdleConns&quot;: 20,
      &quot;MaxOpenConns&quot;: 300,
      &quot;Trace&quot;: false,
      &quot;AtRestEncryptKey&quot;: &quot;&quot;,
      &quot;QueryTimeout&quot;: 30
  }
</pre></div>
</div>
<p>The new settings can be applied by either stopping and starting the server, or by loading the configuration settings as described in the next section.</p>
<p>Once loaded, database write requests are sent to the master database and read requests are distributed among the other databases in the list.</p>
</section>
<section id="load-a-multi-database-configuration-onto-an-active-server">
<h5>Load a multi-database configuration onto an active server<a class="headerlink" href="#load-a-multi-database-configuration-onto-an-active-server" title="Link to this heading">#</a></h5>
<p>After a multi-database configuration has been defined in <code class="docutils literal notranslate"><span class="pre">config.json</span></code>, the following procedure can be used to apply the settings without shutting down the Mattermost server:</p>
<ol class="arabic simple">
<li><p>Go to <strong>System Console &gt; Environment &gt; Web Server</strong>, then select <strong>Reload Configuration from Disk</strong> to reload configuration settings for the Mattermost server from <code class="docutils literal notranslate"><span class="pre">config.json</span></code>.</p></li>
<li><p>Go to <strong>System Console &gt; Environment &gt; Database</strong>, then select <strong>Recycle Database Connections</strong> to take down existing database connections and set up new connections in the multi-database configuration.</p></li>
</ol>
<p>While the connection settings are changing, there might be a brief moment when writes to the master database are unsuccessful. The process waits for all existing connections to finish and starts serving new requests with the new connections. End users attempting to send messages while the switch is happening will have an experience similar to losing connection to the Mattermost server.</p>
</section>
<section id="manual-failover-for-master-database">
<h5>Manual failover for master database<a class="headerlink" href="#manual-failover-for-master-database" title="Link to this heading">#</a></h5>
<p>If the need arises to switch from the current master database - for example, if it is running out of disk space, or requires maintenance updates, or for other reasons - you can switch Mattermost server to use one of its read replicas as a master database by updating <code class="docutils literal notranslate"><span class="pre">DataSource</span></code> in <code class="docutils literal notranslate"><span class="pre">config.json</span></code>.</p>
<p>To apply the settings without shutting down the Mattermost server:</p>
<ol class="arabic simple">
<li><p>Go to <strong>System Console &gt; Environment &gt; Web Server</strong>, then select <strong>Reload Configuration from Disk</strong> to reload configuration settings for the Mattermost server from <code class="docutils literal notranslate"><span class="pre">config.json</span></code>.</p></li>
<li><p>Go to <strong>System Console &gt; Environment &gt; Database</strong>, then select <strong>Recycle Database Connections</strong> to take down existing database connections and set up new connections in the multi-database configuration.</p></li>
</ol>
<p>While the connection settings are changing, there might be a brief moment when writes to the master database are unsuccessful. The process waits for all existing connections to finish and starts serving new requests with the new connections. End users attempting to send messages while the switch is happening can have an experience similar to losing connection to the Mattermost server.</p>
</section>
<section id="transparent-failover">
<h5>Transparent failover<a class="headerlink" href="#transparent-failover" title="Link to this heading">#</a></h5>
<p>The database can be configured for high availability and transparent failover use the existing database technologies. We recommend PostgreSQL Clustering or Amazon Aurora. Database transparent failover is beyond the scope of this documentation.</p>
</section>
<section id="recommended-configuration-settings-for-postgresql">
<h5>Recommended configuration settings for PostgreSQL<a class="headerlink" href="#recommended-configuration-settings-for-postgresql" title="Link to this heading">#</a></h5>
<p>If you’re using PostgreSQL as the choice of database, we recommend the following configuration optimizations on your Mattermost server. These  configurations were tested on an AWS Aurora r5.xlarge instance of PostgreSQL 11.7. There are also some general optimizations mentioned which requires servers with higher specifications.</p>
<ol class="arabic simple">
<li><p><strong>max_connections</strong>: If you are using read-replicas, set reader connections to 1024, and set writer connections to 256. If you are using a single instance, then only setting reader connections to 1024 should be sufficient. If the instance is lower capacity than r5.xlarge, then set it to a lower number. Also tune the <code class="docutils literal notranslate"><span class="pre">MaxOpenConns</span></code> setting under the <code class="docutils literal notranslate"><span class="pre">SqlSettings</span></code> of the Mattermost app accordingly.</p></li>
<li><p><strong>random_page_cost</strong>: Set it to 1.1, unless the DB is using spinning disks.</p></li>
<li><p><strong>work_mem</strong>: Set it to 16MB for readers, and 32MB for writers. If it’s a single instance, 16MB should be sufficient. If the instance is of a lower capacity than r5.xlarge, then set it to a lower number.</p></li>
<li><p><strong>effective_cache_size</strong>: Set it to 65% of total memory. For a 32GB instance, it should be 21GB.</p></li>
<li><p><strong>shared_buffers</strong>: Set it to 65% of total memory. For a 32GB instance, it should be 21GB.</p></li>
<li><p><strong>tcp_keepalives_count</strong>: 5</p></li>
<li><p><strong>tcp_keepalives_idle</strong>: 5</p></li>
<li><p><strong>tcp_keepalives_interval</strong>: 1</p></li>
<li><p>If you have more than 32 CPUs, please set the following options to utilize more CPU for your server:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>max_worker_processes</strong>: 12</p></li>
<li><p><strong>max_parallel_workers_per_gather</strong>: 4</p></li>
<li><p><strong>max_parallel_workers</strong>: 12</p></li>
<li><p><strong>max_parallel_maintenance_workers</strong>: 4</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p><strong>autovacuum_max_workers</strong>: 4</p></li>
<li><p><strong>maintenance_work_mem</strong>: 1GB (reduce this to 512MB if your server has less than 32GB of RAM)</p></li>
<li><p><strong>autovacuum_vacuum_cost_limit</strong>: 500</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using pgbouncer, or any similar connection pooling proxy, in front of your DB, then apply the keepalive settings to the proxy instead, and revert the keepalive settings for the DB back to defaults.</p>
</div>
</section>
</section>
<section id="leader-election">
<h4>Leader election<a class="headerlink" href="#leader-election" title="Link to this heading">#</a></h4>
<p>A cluster leader election process assigns any scheduled task such as LDAP sync to run on a single node in a multi-node cluster environment.</p>
<p>The process is based on a widely used <a class="reference external" href="https://en.wikipedia.org/wiki/Bully_algorithm">bully leader election algorithm</a> where the process with the lowest node ID number from amongst the non-failed processes is selected as the leader.</p>
</section>
<section id="job-server">
<h4>Job server<a class="headerlink" href="#job-server" title="Link to this heading">#</a></h4>
<p>Mattermost runs periodic tasks via the <a class="reference external" href="/configure/configuration-settings.html#jobs">job server</a>. These tasks include:</p>
<ul class="simple">
<li><p>LDAP sync</p></li>
<li><p>Data retention</p></li>
<li><p>Compliance exports</p></li>
<li><p>Elasticsearch indexing</p></li>
</ul>
<p>Make sure you have set <code class="docutils literal notranslate"><span class="pre">JobSettings.RunScheduler</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code> in <code class="docutils literal notranslate"><span class="pre">config.json</span></code> for all app and job servers in the cluster. The cluster leader will then be responsible for scheduling recurring jobs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended not to change this setting from the default setting of <code class="docutils literal notranslate"><span class="pre">true</span></code> as this prevents the <code class="docutils literal notranslate"><span class="pre">ClusterLeader</span></code> from being able to run the scheduler. As a result, recurring jobs such as LDAP sync, Compliance Export, and data retention will no longer be scheduled.</p>
</div>
<p>In previous Mattermost Server versions, and this documentation, the instructions stated to run the Job Server with <code class="docutils literal notranslate"><span class="pre">RunScheduler:</span> <span class="pre">false</span></code>. The cluster design has evolved and this is no longer the case.</p>
</section>
<section id="plugins-and-high-availability">
<h4>Plugins and High Availability<a class="headerlink" href="#plugins-and-high-availability" title="Link to this heading">#</a></h4>
<p>When you install or upgrade a plugin, it’s propagated across the servers in the cluster automatically. File storage is assumed to be shared between all the servers, using services such as NAS or Amazon S3.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">&quot;DriverName&quot;:</span> <span class="pre">&quot;local&quot;</span></code> is used then the directory at <code class="docutils literal notranslate"><span class="pre">&quot;FileSettings&quot;:</span></code> <code class="docutils literal notranslate"><span class="pre">&quot;Directory&quot;:</span> <span class="pre">&quot;./data/&quot;</span></code> is expected to be a NAS location mapped as a local directory. If this is not the case High Availability will not function correctly and may corrupt your file storage.</p>
<p>When you reinstall a plugin in v5.14, the previous <strong>Enabled</strong> or <strong>Disabled</strong> state is retained. As of v5.15, a reinstalled plugin’s initial state is <strong>Disabled</strong>.</p>
</section>
<section id="cli-and-high-availability">
<h4>CLI and High Availability<a class="headerlink" href="#cli-and-high-availability" title="Link to this heading">#</a></h4>
<p>The CLI is run in a single node which bypasses the mechanisms that a <a class="reference external" href="/scale/high-availability-cluster.html">high availability environment</a> uses to perform actions across all nodes in the cluster. As a result, when running <a class="reference external" href="/manage/command-line-tools.html">CLI commands</a> in a High Availability environment, tasks such as updating and deleting users or changing configuration settings require a server restart.</p>
<p>We recommend using <a class="reference external" href="/manage/mmctl-command-line-tool.html">mmctl</a> in a high availability environment instead since a server restart is not required. These changes are made through the API layer, so the node receiving the change request notifies all other nodes in the cluster.</p>
</section>
</section>
</section>
<section id="upgrade-guide">
<h2>Upgrade guide<a class="headerlink" href="#upgrade-guide" title="Link to this heading">#</a></h2>
<p>An update is an incremental change to Mattermost server that fixes bugs or performance issues. An upgrade adds new or improved functionality to the server.</p>
<section id="update-configuration-changes-while-operating-continuously">
<h3>Update configuration changes while operating continuously<a class="headerlink" href="#update-configuration-changes-while-operating-continuously" title="Link to this heading">#</a></h3>
<p>A service interruption is not required for most configuration updates. See the section below for details on upgrades requiring service interruption. You can apply updates during a period of low load, but if your high availability cluster is sized correctly, you can do it at any time. The system downtime is brief, and depends on the number of Mattermost servers in your cluster. Note that you are not restarting the machines, only the Mattermost server applications. A Mattermost server restart generally takes about five seconds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don’t modify configuration settings through the System Console, otherwise you’ll have two servers with different <code class="docutils literal notranslate"><span class="pre">config.json</span></code> files in a high availability cluster causing a refresh every time a user connects to a different app server.</p>
</div>
<ol class="arabic simple">
<li><p>Make a backup of your existing <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file.</p></li>
<li><p>For one of the Mattermost servers, make the configuration changes to <code class="docutils literal notranslate"><span class="pre">config.json</span></code> and save the file. Do not reload the file yet.</p></li>
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file to the other servers.</p></li>
<li><p>Shut down Mattermost on all but one server.</p></li>
<li><p>Reload the configuration file on the server that is still running. Go to <strong>System Console &gt; Environment &gt; Web Server</strong>, then select <strong>Reload Configuration from Disk</strong>.</p></li>
<li><p>Start the other servers.</p></li>
</ol>
</section>
<section id="update-the-server-version-while-operating-continuously">
<h3>Update the Server version while operating continuously<a class="headerlink" href="#update-the-server-version-while-operating-continuously" title="Link to this heading">#</a></h3>
<p>A service interruption is not required for security patch dot releases of Mattermost Server. You can apply updates during a period when the anticipated load is small enough that one server can carry the full load of the system during the update.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mattermost supports one minor version difference between the server versions when performing a rolling upgrade (for example v5.27.1 + v5.27.2 or v5.26.4 + v5.27.1 is supported, whereas v5.25.5 + v5.27.0 is not supported). Running two different versions of Mattermost in your cluster should not be done outside of an upgrade scenario.</p>
</div>
<p>When restarting, you aren’t restarting the machines, only the Mattermost server applications. A Mattermost server restart generally takes about five seconds.</p>
<ol class="arabic simple">
<li><p>Review the upgrade procedure in the <em>Upgrade Enterprise Edition</em> section of <a class="reference internal" href="../upgrade/upgrading-mattermost-server.html"><span class="doc">Upgrade Mattermost Server</span></a>.</p></li>
<li><p>Make a backup of your existing <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file.</p></li>
<li><p>Set your proxy to move all new requests to a single server. If you are using NGINX and it’s configured with an upstream backend section in <code class="docutils literal notranslate"><span class="pre">/etc/nginx/sites-available/mattermost</span></code> then comment out all but the one server that you intend to update first, and reload NGINX.</p></li>
<li><p>Shut down Mattermost on each server except the one that you are updating first.</p></li>
<li><p>Update each Mattermost instance that is shut down.</p></li>
<li><p>On each server, replace the new <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file with your backed up copy.</p></li>
<li><p>Start the Mattermost servers.</p></li>
<li><p>Repeat the update procedure for the server that was left running.</p></li>
</ol>
</section>
<section id="server-upgrades-requiring-service-interruption">
<h3>Server upgrades requiring service interruption<a class="headerlink" href="#server-upgrades-requiring-service-interruption" title="Link to this heading">#</a></h3>
<p>A service interruption is required when the upgrade includes a change to the database schema or when a change to <code class="docutils literal notranslate"><span class="pre">config.json</span></code> requires a server restart, such as when making the following changes:</p>
<ul class="simple">
<li><p>Default server language</p></li>
<li><p>Rate limiting</p></li>
<li><p>Webserver mode</p></li>
<li><p>Database</p></li>
<li><p>High availability</p></li>
</ul>
<p>If the upgrade includes a change to the database schema, the database is upgraded by the first server that starts.</p>
<p>Apply upgrades during a period of low load. The system downtime is brief, and depends on the number of Mattermost servers in your cluster. Note that you are not restarting the machines, only the Mattermost server applications.</p>
<ol class="arabic simple">
<li><p>Review the upgrade procedure in the <em>Upgrade Enterprise Edition</em> section of <a class="reference internal" href="../upgrade/upgrading-mattermost-server.html"><span class="doc">Upgrade Mattermost Server</span></a>.</p></li>
<li><p>Make a backup of your existing <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file.</p></li>
<li><p>Stop NGINX.</p></li>
<li><p>Upgrade each Mattermost instance.</p></li>
<li><p>On each server, replace the new <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file with your backed up copy.</p></li>
<li><p>Start one of the Mattermost servers.</p></li>
<li><p>When the server is running, start the other servers.</p></li>
<li><p>Restart NGINX.</p></li>
</ol>
</section>
<section id="upgrade-to-version-4-0-and-later">
<h3>Upgrade to version 4.0 and later<a class="headerlink" href="#upgrade-to-version-4-0-and-later" title="Link to this heading">#</a></h3>
<p>When a server starts up, it can automatically discover other servers in the same cluster. You can add and remove servers without the need to make changes to the configuration file, <code class="docutils literal notranslate"><span class="pre">config.json</span></code>. To support this capability, new items were added to the <code class="docutils literal notranslate"><span class="pre">ClusterSettings</span></code> section of <code class="docutils literal notranslate"><span class="pre">config.json</span></code>. When upgrading from v3.10 or earlier to v4.0 or later, you must manually add the new items to your existing <code class="docutils literal notranslate"><span class="pre">config.json</span></code>.</p>
<ol class="arabic simple">
<li><p>Review the upgrade procedure in <a class="reference internal" href="../upgrade/upgrading-mattermost-server.html"><span class="doc">Upgrade Mattermost Server</span></a>.</p></li>
<li><p>Make a backup of your existing <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file.</p></li>
<li><p>Revise your existing <code class="docutils literal notranslate"><span class="pre">config.json</span></code> to update the <code class="docutils literal notranslate"><span class="pre">ClusterSettings</span></code> section. The following settings should work in most cases:</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;ClusterSettings&quot;: {
    &quot;Enable&quot;: true,
    &quot;ClusterName&quot;: &quot;production&quot;,
    &quot;OverrideHostname&quot;: &quot;&quot;,
    &quot;UseIpAddress&quot;: true,
    &quot;UseGossip&quot;: true,
    &quot;ReadOnlyConfig&quot;: true,
    &quot;GossipPort&quot;: 8074,
    &quot;StreamingPort&quot;: 8075
},
</pre></div>
</div>
<p>For more information about these settings, see the <a class="reference external" href="/configure/environment-configuration-settings.html#high-availability">high availability configuration settings</a> documentation.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Stop NGINX.</p></li>
<li><p>Upgrade each Mattermost instance.</p></li>
<li><p>On each server, replace the new <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file with your modified version.</p></li>
<li><p>Start one of the Mattermost servers.</p></li>
<li><p>When the server is running, start the other servers.</p></li>
<li><p>Restart NGINX.</p></li>
</ol>
</section>
<section id="all-cluster-nodes-must-use-a-single-protocol">
<h3>All cluster nodes must use a single protocol<a class="headerlink" href="#all-cluster-nodes-must-use-a-single-protocol" title="Link to this heading">#</a></h3>
<p>All cluster traffic uses the gossip protocol. <a class="reference external" href="/configure/configuration-settings.html#use-gossip">Gossip clustering can no longer be disabled</a>.</p>
<p>When upgrading a high availability cluster, you can’t upgrade other nodes in the cluster when one node isn’t using the gossip protocol. You must use gossip to complete a high availability upgrade. Alternatively you can shut down all nodes and bring them all up individually following an upgrade.</p>
</section>
</section>
<section id="frequently-asked-questions-faq">
<h2>Frequently asked questions (FAQ)<a class="headerlink" href="#frequently-asked-questions-faq" title="Link to this heading">#</a></h2>
<section id="does-mattermost-support-multi-region-high-availability-deployment">
<h3>Does Mattermost support multi-region high availability deployment?<a class="headerlink" href="#does-mattermost-support-multi-region-high-availability-deployment" title="Link to this heading">#</a></h3>
<p>Yes. Although not officially tested, you can set up a cluster across AWS regions, for example, and it should work without issues.</p>
</section>
<section id="what-does-mattermost-recommend-for-disaster-recovery-of-the-databases">
<h3>What does Mattermost recommend for disaster recovery of the databases?<a class="headerlink" href="#what-does-mattermost-recommend-for-disaster-recovery-of-the-databases" title="Link to this heading">#</a></h3>
<p>When deploying Mattermost in a high availability configuration, we recommend using a database load balancer between Mattermost and your database. Depending on your deployment this needs more or less consideration.</p>
<p>For example, if you’re deploying Mattermost on AWS with Amazon Aurora we recommend utilizing multiple Availability Zones. If you’re deploying Mattermost on your own cluster please consult with your IT team for a solution best suited for your existing architecture.</p>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">#</a></h2>
<section id="capture-high-availability-troubleshooting-data">
<h3>Capture high availability troubleshooting data<a class="headerlink" href="#capture-high-availability-troubleshooting-data" title="Link to this heading">#</a></h3>
<p>When deploying Mattermost in a high availability configuration, we recommend that you keep Prometheus and Grafana metrics as well as cluster server logs for as long as possible - and at minimum two weeks.</p>
<p>You may be asked to provide this data to Mattermost for analysis and troubleshooting purposes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Ensure that server log files are being created. You can find more on working with Mattermost logs <a class="reference external" href="/install/troubleshooting.html#review-mattermost-logs">here</a>.</p></li>
<li><p>When investigating and replicating issues, we recommend opening <strong>System Console &gt; Environment &gt; Logging</strong> and setting <strong>File Log Level</strong> to <strong>DEBUG</strong> for more complete logs. Make sure to revert to <strong>INFO</strong> after troubleshooting to save disk space.</p></li>
<li><p>Each server has its own server log file, so make sure to provide server logs for all servers in your High Availability cluster.</p></li>
</ul>
</div>
</section>
<section id="red-server-status">
<h3>Red server status<a class="headerlink" href="#red-server-status" title="Link to this heading">#</a></h3>
<p>When high availability is enabled, the System Console displays the server status as red or green, indicating if the servers are communicating correctly with the cluster. The servers use inter-node communication to ping the other machines in the cluster, and once a ping is established the servers exchange information, such as server version and configuration files.</p>
<p>A server status of red can occur for the following reasons:</p>
<ul class="simple">
<li><p><strong>Configuration file mismatch:</strong> Mattermost will still attempt the inter-node communication, but the System Console will show a red status for the server since the high availability feature assumes the same configuration file to function properly.</p></li>
<li><p><strong>Server version mismatch:</strong> Mattermost will still attempt the inter-node communication, but the System Console will show a red status for the server since the high availability feature assumes the same version of Mattermost is installed on each server in the cluster. It is recommended to use the <a class="reference external" href="https://mattermost.com/download/">latest version of Mattermost</a> on all servers. Follow the upgrade procedure in <a class="reference internal" href="../upgrade/upgrading-mattermost-server.html"><span class="doc">Upgrade Mattermost Server</span></a> for any server that needs to be upgraded.</p></li>
<li><p><strong>Server is down:</strong> If an inter-node communication fails to send a message it makes another attempt in 15 seconds. If the second attempt fails, the server is assumed to be down. An error message is written to the logs and the System Console shows a status of red for that server. The inter-node communication continues to ping the down server in 15 second intervals. When the server comes back up, any new messages are sent to it.</p></li>
</ul>
</section>
<section id="websocket-disconnect">
<h3>WebSocket disconnect<a class="headerlink" href="#websocket-disconnect" title="Link to this heading">#</a></h3>
<p>When a client WebSocket receives a disconnect it will automatically attempt to re-establish a connection every three seconds with a backoff. After the connection is established, the client attempts to receive any messages that were sent while it was disconnected.</p>
</section>
<section id="app-refreshes-continuously">
<h3>App refreshes continuously<a class="headerlink" href="#app-refreshes-continuously" title="Link to this heading">#</a></h3>
<p>When configuration settings are modified through the System Console, the client refreshes every time a user connects to a different app server. This occurs because the servers have different <code class="docutils literal notranslate"><span class="pre">config.json</span></code> files in a high availability cluster.</p>
<p>Modify configuration settings directly through <code class="docutils literal notranslate"><span class="pre">config.json</span></code> <a class="reference external" href="/scale/high-availability-cluster.html#updating-configuration-changes-while-operating-continuously">following these steps</a>.</p>
</section>
<section id="messages-do-not-post-until-after-reloading">
<h3>Messages do not post until after reloading<a class="headerlink" href="#messages-do-not-post-until-after-reloading" title="Link to this heading">#</a></h3>
<p>When running in high availability mode, make sure all Mattermost application servers are running the same version of Mattermost. If they are running different versions, it can lead to a state where the lower version app server cannot handle a request and the request will not be sent until the frontend application is refreshed and sent to a server with a valid Mattermost version. Symptoms to look for include requests failing seemingly at random or a single application server having a drastic rise in goroutines and API errors.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="elasticsearch.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Elasticsearch</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="scaling-for-enterprise.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Scaling for Enterprise</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2023 Mattermost
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">High availability cluster</a><ul>
<li><a class="reference internal" href="#requirements-for-continuous-operation">Requirements for continuous operation</a></li>
<li><a class="reference internal" href="#deployment-guide">Deployment guide</a><ul>
<li><a class="reference internal" href="#initial-setup-guide-for-high-availability">Initial setup guide for high availability</a></li>
<li><a class="reference internal" href="#add-a-server-to-the-cluster">Add a server to the cluster</a></li>
<li><a class="reference internal" href="#remove-a-server-from-the-cluster">Remove a server from the cluster</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration-and-compatibility">Configuration and compatibility</a><ul>
<li><a class="reference internal" href="#mattermost-server-configuration">Mattermost Server configuration</a><ul>
<li><a class="reference internal" href="#configuration-settings">Configuration settings</a></li>
<li><a class="reference internal" href="#cluster-discovery">Cluster discovery</a></li>
<li><a class="reference internal" href="#time-synchronization">Time synchronization</a></li>
<li><a class="reference internal" href="#state">State</a></li>
<li><a class="reference internal" href="#proxy-server-configuration">Proxy server configuration</a></li>
<li><a class="reference internal" href="#file-storage-configuration">File storage configuration</a></li>
<li><a class="reference internal" href="#database-configuration">Database configuration</a><ul>
<li><a class="reference internal" href="#size-the-databases">Size the databases</a></li>
<li><a class="reference internal" href="#deploy-a-multi-database-configuration">Deploy a multi-database configuration</a></li>
<li><a class="reference internal" href="#load-a-multi-database-configuration-onto-an-active-server">Load a multi-database configuration onto an active server</a></li>
<li><a class="reference internal" href="#manual-failover-for-master-database">Manual failover for master database</a></li>
<li><a class="reference internal" href="#transparent-failover">Transparent failover</a></li>
<li><a class="reference internal" href="#recommended-configuration-settings-for-postgresql">Recommended configuration settings for PostgreSQL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#leader-election">Leader election</a></li>
<li><a class="reference internal" href="#job-server">Job server</a></li>
<li><a class="reference internal" href="#plugins-and-high-availability">Plugins and High Availability</a></li>
<li><a class="reference internal" href="#cli-and-high-availability">CLI and High Availability</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#upgrade-guide">Upgrade guide</a><ul>
<li><a class="reference internal" href="#update-configuration-changes-while-operating-continuously">Update configuration changes while operating continuously</a></li>
<li><a class="reference internal" href="#update-the-server-version-while-operating-continuously">Update the Server version while operating continuously</a></li>
<li><a class="reference internal" href="#server-upgrades-requiring-service-interruption">Server upgrades requiring service interruption</a></li>
<li><a class="reference internal" href="#upgrade-to-version-4-0-and-later">Upgrade to version 4.0 and later</a></li>
<li><a class="reference internal" href="#all-cluster-nodes-must-use-a-single-protocol">All cluster nodes must use a single protocol</a></li>
</ul>
</li>
<li><a class="reference internal" href="#frequently-asked-questions-faq">Frequently asked questions (FAQ)</a><ul>
<li><a class="reference internal" href="#does-mattermost-support-multi-region-high-availability-deployment">Does Mattermost support multi-region high availability deployment?</a></li>
<li><a class="reference internal" href="#what-does-mattermost-recommend-for-disaster-recovery-of-the-databases">What does Mattermost recommend for disaster recovery of the databases?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#capture-high-availability-troubleshooting-data">Capture high availability troubleshooting data</a></li>
<li><a class="reference internal" href="#red-server-status">Red server status</a></li>
<li><a class="reference internal" href="#websocket-disconnect">WebSocket disconnect</a></li>
<li><a class="reference internal" href="#app-refreshes-continuously">App refreshes continuously</a></li>
<li><a class="reference internal" href="#messages-do-not-post-until-after-reloading">Messages do not post until after reloading</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>